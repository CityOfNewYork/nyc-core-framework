<footer class="theme-primary font-size-md text-align-center">

    <h2 class="screen-reader-only">
        Page Footer
    </h2>

    <div class="container overflow-hidden">

        <div class="narrow margin-y-4">

            <p>
                <strong>NYC Core Framework</strong><br>
                Current version: 2.0 - Battery Park
            </p>

            <div class="margin-y-3">

                <a class="display-none margin-bottom-2" href="https://www1.nyc.gov" title="Go to nyc.gov" data-logo="brand">

                    <svg xmlns="http://www.w3.org/2000/svg" width="120" height="40" viewBox="0 0 120 40">
                       <g>
                           <polygon points="87.5 0 80 7.5 80 2.5 77.5 0 67.5 0 65 2.5 65 7.5 60 12.5 55 7.5 55 2.5 52.5 0 42.5 0 40 2.5 37.5 0 27.5 0 25 2.5 25 12.5 12.501 0 2.501 0 0 2.5 0 37.5 2.501 40 12.501 40 15 37.5 15 27.5 27.5 40 37.5 40 40 37.5 40 17.5 52.5 30 52.5 37.5 55 40 65 40 67.5 37.5 67.5 30 80 17.5 80 32.5 87.5 40 112.5 40 120 32.5 120 25 117.5 22 105 22 105 25 95 25 95 15 105 15 105 18 117.5 18 120 15 120 7.5 112.5 0 87.5 0" />
                           <path d="M117.9877,1.8787h.293l.4888.8088h.3522l-.53-.831a.4834.4834,0,0,0,.4927-.517c0-.3837-.2322-.5435-.6895-.5435h-.718V2.6875h.3105Zm0-.8182h.3758c.1867,0,.411.0278.411.2568,0,.2742-.2055.2962-.4385.2962h-.3483Z" />
                           <path d="M118.3265,3.42A1.6573,1.6573,0,0,0,120,1.71a1.6784,1.6784,0,1,0-3.3563,0A1.6456,1.6456,0,0,0,118.3265,3.42Zm0-3.1218A1.3255,1.3255,0,0,1,119.6342,1.71a1.3157,1.3157,0,1,1-2.6242,0A1.3271,1.3271,0,0,1,118.3265.2977Z" />
                       </g>
                   </svg>

                </a>

                <p class="margin-bottom-2">
                    &#169; 2020 - City of New York. All Rights Reserved. The NYC Core Framework is created and
                    maintained by NYC Information Technology and Telecommunications.
                </p>

                <ul class="nav nav--horizontal font-size-sm justify-content-center">
                    <li>
                        <a class="text-reset" href="http://www1.nyc.gov/home/privacy-policy.page">
                            Privacy Policy
                        </a>
                    </li>
                    <li>
                        <a class="text-reset" href="http://www1.nyc.gov/home/terms-of-use.page">
                            Terms of Use
                        </a>
                    </li>
                </ul>

            </div>
            <!-- .margin-y-3 -->

        </div>

    </div>
    <!-- .container -->

    <div class="container padding-y-2 border-top">
        <a href="#" data-scroll="top">
            Back to Top
        </a>
    </div>

</footer>

{% if page.title == 'Home' %}

<script src="{{ site.baseurl }}/dist/js/home.js"></script>

{% endif %}

{% if page.title == 'Customization' %}

<script>

    const customPropertiesData = "{{ site.baseurl }}/lib/json/root-custom-properties.json";
    const customPropertiesContainer = document.getElementById("all-custom-properties");
    const customPropertiesTable = customPropertiesContainer.querySelector(".table-scroll__container");

    const copyButtonText = "Copy";
    const copyButtonActionText = "Copied!";

    const hash = window.location.hash;

    const checkAchor = () => {
        if (window.location.hash) {
            console.log("window.location.hash : " +  hash);
            window.location.href = hash;
        }
    };

    const loadcustomProperties = async () => {
        try {
            const response = await fetch(customPropertiesData);
            const customPropertyData = await response.json();

            console.log("customPropertyData ===== >", customPropertyData);
            
            displayCustomProperties(customPropertyData);

            initClipboard();
            checkAchor();
        
        } catch (err) {
            console.error(err);
        }
    };

    const displayCustomProperties = (customProperties) => {

        const customProperyHTML = customProperties.map((customPropertyArray) => {

            let type = customPropertyArray.type;
            let properties = customPropertyArray.customProperties;
            let scope = customPropertyArray.scope;

            let id = type.replace(/\s+/g, '-').toLowerCase();

            let slug;

            if(type === 'Gradient Veneer' || type === 'Subtle Fill') {
                slug = 'accents/#' + id;
            } else {
                slug = id;
            }

            let cpRows = properties.map((property) => {
                return `
                    <tr>
                        <td>
                          <span data-prop>--${property.name}</span>
                        </td>
                        <td>
                            <span data-val>${property.value}</span>
                        </td>
                        <td>  
                            <button data-clipboard="single">
                                ${copyButtonText}
                            </button>
                        </td>
                        <td>
                            ${property.description}
                        </td>
                    </tr>
                `;
            }).join('');

            return `
                <div class="cp-header box-shadow-1" id="cp_${id}">
                    <span class="cp-header__title">${type}</span>
                    <a class="cp-header__link button button--has-icon" href="{{ site.baseurl }}/docs/${slug}">
                        <span class="button__text">Docs</span>
                        <span class="nyc_icon_arrow-right button__icon"></span>
                    </a>
                </div>
                <table class="table">
                    <caption class="border-bottom">
                        <p class="font-size-md">
                            Variable scope: <code>${scope}</code>
                        </p>
                    </caption>
                    <thead>
                        <tr>
                            <th scope="col">
                                CSS Variable
                            </th>
                            <th scope="col">Default Value</th>
                            <th scope="col">
                                <button data-clipboard="all">
                                    <span>Copy All</span>
                                </button>
                            </th>
                            <th scope="col">Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${cpRows}
                    </tbody>

                </table>
            `;

        }).join('');

        customPropertiesTable.innerHTML = customProperyHTML;
    };

    const initClipboard = () => {
        
        const allCPButtonList = document.querySelectorAll('[data-clipboard="all"]');
        const cpButtonList = document.querySelectorAll('[data-clipboard="single"]');

        allCPButtonList.forEach((cpButton) => {

            cpButton.addEventListener('click', (event) => {

                event.preventDefault();

                let currentTable = event.target.closest("table");
                let currentTableRowsList = currentTable.querySelectorAll("tbody > tr");
                let currentTableSingleButtonList = currentTable.querySelectorAll('[data-clipboard="single"]');

                currentTableSingleButtonList.forEach((singleButton) => {
                    singleButton.innerHTML = copyButtonActionText.toString(); 
                });

                let currentCPArray = [];

                currentTableRowsList.forEach((row) => {

                    let cpName = row.querySelector('[data-prop]').innerHTML.trim().replace(/&nbsp;/g, '');
                    let cpValue = row.querySelector('[data-val]').innerHTML.trim().replace(/&nbsp;/g, '');
                    let cpText = `${cpName}: ${cpValue};`;

                    currentCPArray.push(cpText);

                });

                let myClipboardProperties = currentCPArray.map((property) => {

                    return `    ${property}`
                
                }).join('\n');
                
                let myClipboardText = `
                    :root {
                        ${myClipboardProperties}
                    }`;

                // Create an auxiliary hidden input
                var aux = document.createElement( 'textarea' );

                // Get the text from the element passed into the input
                aux.innerHTML = myClipboardText.trim();

                // Append the aux input to the body
                document.body.appendChild(aux);

                // Highlight the content
                aux.select();

                // Execute the copy command
                document.execCommand( 'copy' );

                // Remove the input from the body
                document.body.removeChild(aux);

            });

        });

        cpButtonList.forEach((cpButton) => {

            const resetButton = () => {
                cpButtonList.forEach((otherButtons)=> {
                    otherButtons.innerHTML = copyButtonText;
                });
            }

            cpButton.addEventListener('click', (event) => {

                event.preventDefault();
                resetButton();
                
                let currentRow = event.target.closest('tr');

                let myCustomPropertyName = currentRow.querySelector('[data-prop]').innerHTML.trim().replace(/&nbsp;/g, '');
                let myCustomPropertyValue = currentRow.querySelector('[data-val]').innerHTML.trim().replace(/&nbsp;/g, '');
                let myClipboardText = `${myCustomPropertyName}: ${myCustomPropertyValue};`;

                if( myClipboardText ){
                    event.target.innerHTML = copyButtonActionText;
                }

                // Create an auxiliary hidden input
                var aux = document.createElement( 'input' );

                // Get the text from the element passed into the input
                aux.setAttribute( 'value', myClipboardText );

                // Append the aux input to the body
                document.body.appendChild(aux);

                // Highlight the content
                aux.select();

                // Execute the copy command
                document.execCommand( 'copy' );

                // Remove the input from the body
                document.body.removeChild(aux);

            });
    
        });

    };

    loadcustomProperties();
    
</script>

{% endif %}


{% if page.title == 'NYC Core Icons' %}

<script defer src="{{ site.baseurl }}/dist/js/icon_display.js"></script>

{% endif %}

{% if page.url contains '/docs' %}

<script src="{{ site.baseurl }}/lib/js/prism.js"></script>

<script src="{{ site.baseurl }}/dist/js/table_of_contents.js"></script>

<script>

    window.addEventListener('DOMContentLoaded', (event) => {

    const docPagesData = "{{ site.baseurl }}/lib/json/documentation-pages.json";

    let allPagesArray = [];

    const loadDocPagesData = async () => {
        try {
            const response = await fetch(docPagesData);
            const docPages = await response.json();

            const docPagesObject = docPages.docs;

            docPagesObject.forEach((category) => {
                const collectionName = category.collection;
                const collectionPages = category.pages;

                if(collectionPages.length) {
                    collectionPages.forEach((page) => {
                        allPagesArray.push(page);
                    });
                }

            });

        } catch (err) {
            console.warn(err);
        }
    };

    const docsSidebar = document.querySelector('#docs-sidebar');

    const filterDocsInput = document.querySelector('#filter-docs-input');

    const filterPages = (pages) => {

        let filteredPagesArray = [];

        pages.forEach((page) => {
            let pageTitle = page.title;
            filteredPagesArray.push(pageTitle);
        });

        filterMenu(filteredPagesArray);
    }

    const filterMenu = (keepInMenu) => {

        const menuItemList = docsSidebar.querySelectorAll("li");

        let checkString = keepInMenu.toString();

        menuItemList.forEach((menuItem) => {
            
            let dataTitle = menuItem.getAttribute("data-title");
            
            if (!(checkString.includes(dataTitle))) {
                menuItem.classList.add("hide");
            } else {
                menuItem.classList.remove("hide");
            }
        });
    }

    filterDocsInput.addEventListener('keyup', (event) => {

        const searchQuery = event.target.value.toLowerCase();

        let searchResults = allPagesArray.filter((result) => {
            return (
                result.title.toLowerCase().includes(searchQuery) ||
                result.tags.toString().toLowerCase().includes(searchQuery)
            );
        });

        if (searchQuery !== "") {
            docsSidebar.classList.add("filtered");
            filterPages(searchResults);
        } else {
            docsSidebar.classList.remove("filtered");
        }

    });


    loadDocPagesData();

    });

</script>

{% endif %}

{% if page.url contains '/docs' or '/templates' %}

<script defer src="{{ site.baseurl }}/dist/js/iframe_height.js"></script>

{% endif %}

<script src="https://cdn.jsdelivr.net/gh/CityOfNewYork/nyc-core-framework@new-version/dist/js/nyc_core.js"></script>